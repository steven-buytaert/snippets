// Copyright 2023 Steven Buytaert

#include <stdint.h>

uint32_t sbtbuz1(const void * d, uint32_t s, uint32_t seed) {

  uint32_t        i;
  const uint8_t * c;
  uint32_t        hash = seed;

  static const uint32_t buztab[256] = {
    0x0fac9842, 0x079c118a, 0x0c7f291e, 0x437eca95, 
    0xd1effcd1, 0x31277b95, 0x7d15ea2e, 0xa3f53fb4, 
    0x0b1d52da, 0xaa132f7b, 0x537a17d5, 0x95222552, 
    0xdee6a5fb, 0xd9bf895e, 0xd70a2176, 0xcf9f46a9, 
    0xc6d2d4fa, 0xbb81b2c4, 0x46aa1055, 0x1062557e, 
    0x2b9192f4, 0x7f0444a0, 0x3b3466b5, 0xcbd9f06e, 
    0x34e3b700, 0x36883f3d, 0xa88f13ba, 0xbe5df34e, 
    0x5e5dbf1f, 0xfeceed5d, 0xc3e63026, 0x5b0e0226, 
    0xe1511675, 0x5269a02a, 0x5db0b324, 0x075808c1, 
    0xfb6d527d, 0xbed6e74b, 0xb8f11fcc, 0x6d889dab, 
    0xb39ae228, 0x7113131b, 0x7c22c98f, 0x3c8b65ee, 
    0xe614fb16, 0x068c2838, 0x67f8a7e3, 0x6eecc1ba, 
    0xb9a56a1f, 0x0e365a8b, 0x5a47cf0c, 0x1686f284, 
    0x22c8b0b6, 0x3620fa13, 0x8cc5e0ad, 0xf08d4c20, 
    0xa0d22cf3, 0x6f8be82b, 0x8de56f43, 0x7b8629e3, 
    0xd448716c, 0x79ff2840, 0x96b272c2, 0xe124cd50, 
    0x83f9b259, 0xdb3d5716, 0x487e5425, 0xe1628d8b, 
    0xb052ce61, 0x15bf4444, 0xad04d896, 0x4333ddf3, 
    0x8650ac1d, 0xde1d752f, 0x2fb45c10, 0x0c3fcb38, 
    0xefe86ffe, 0x51637aee, 0x7f9291e0, 0x94d5609f, 
    0x4be3901e, 0x9778fcd4, 0x046986a6, 0x06000ce5, 
    0xe0650ef9, 0xc3a99d4b, 0x228495b4, 0x87b27781, 
    0x642a5c9a, 0xccfa0241, 0x95d7e460, 0x936693bc, 
    0x68965cd5, 0x6890b5af, 0x9a754bfb, 0xa5cef94d, 
    0x7b4bd98a, 0x32bd0bdf, 0x6f8ff163, 0x9a506758, 
    0x93ba1c09, 0x00e023d8, 0xea8b1767, 0x0b90fa1a, 
    0x7dc1b0a6, 0x9fbbb6db, 0x1ab50754, 0x89e69955, 
    0x0334f670, 0x5eab00b2, 0x3931cd57, 0xd8408349, 
    0xda37ee3a, 0x1f730e22, 0x0c8abebf, 0xe1076ffd, 
    0xe031efa8, 0x07ad39cf, 0x432b496d, 0x48033dcd, 
    0x275fc2b6, 0xf4b898ac, 0x869846ed, 0x3528d0ed, 
    0x304dec68, 0x3c2c3561, 0x9f936595, 0x9dc2c9a9, 
    0x79d5cf8c, 0xaac58736, 0x50139e03, 0x14e88aef, 
    0xe74b038b, 0x2d87541b, 0x8006bb91, 0x894c6442, 
    0xd5018cdd, 0x58390d91, 0x4a8785d1, 0x3b3c4d69, 
    0x45a52e8f, 0x53677fa2, 0xeffc30d4, 0xf221b949, 
    0xb92a16d7, 0xa4dceedf, 0xb4e4a77e, 0x3267be29, 
    0xe86b456b, 0x697831e0, 0xa17c3724, 0xfaf283d0, 
    0x0852281d, 0x42077807, 0xcd60be80, 0xdf3f4d33, 
    0x75bb5eab, 0xb013e288, 0xd635a389, 0x0948cfb6, 
    0xd9bf6779, 0x0a4ffb41, 0x4ed628d5, 0xd5093ba4, 
    0x722e5cdc, 0x66e94050, 0xa1f04f5e, 0x4a4ff402, 
    0x3ad0fea5, 0x829c2a3b, 0x84d3f147, 0x15bbc2bc, 
    0xed03604a, 0xea8a406a, 0x35ed9856, 0xc8fbfa2c, 
    0x276a205e, 0xcce8d599, 0x59c89561, 0xa6d0f9c8, 
    0x4c28811a, 0xdb82af66, 0xb57e96aa, 0x2272187f, 
    0x289b0033, 0x8f1fb4f4, 0x76bf8f08, 0x0ccbdf5f, 
    0x0c1c7764, 0x757fc889, 0x7a79647d, 0x3ca35365, 
    0xa8306473, 0x5e040d83, 0x6083d865, 0xe0996433, 
    0xb1e82b6c, 0x580757b4, 0x7a1fc35c, 0x0970dc26, 
    0xd33d96c1, 0x9c400291, 0xecea2256, 0x1d633125, 
    0xbc7f9352, 0xf0399c98, 0x6e54ca48, 0x269c1bd7, 
    0x91d4edb6, 0x72d51ef8, 0x54cac2a5, 0x33748739, 
    0x5b7a83bf, 0x67c6c31f, 0xa7cdf923, 0x800771e0, 
    0x9fe94144, 0x3f7139b3, 0x11165ba4, 0xd560b557, 
    0x8c86f992, 0xf37311b0, 0xa1a0acfc, 0xa10defd7, 
    0x5dd40613, 0xe71e1cc3, 0x96ef5e8f, 0xab45e0c4, 
    0xe40b99cf, 0x65652115, 0xfac46f01, 0xb14eeb19, 
    0x12f82ada, 0xd1895011, 0xddeed0f4, 0xc3c4a4f8, 
    0xe53a8ee4, 0xb27f420a, 0x61de6aa4, 0xb47701b3, 
    0xd714aecd, 0x451c4c9a, 0xafa5b40a, 0x8c73232c, 
    0xe594b832, 0x5a0152f3, 0xadb7bfc4, 0x94c2b326, 
    0x4dcfa18e, 0xf865debe, 0x6e5b5f63, 0x721bbd3b, 
    0xa8981e4c, 0x2cfe65eb, 0x9a7c37a3, 0x46957a7a, 
  };
  
  for (c = d, i = s; i; i--, c++) {
    hash = ((hash >> 1) | (hash << 31)) ^ buztab[*c];
  }

  return hash;

}
