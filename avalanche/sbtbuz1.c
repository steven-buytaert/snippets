// Copyright 2023 Steven Buytaert

#include <stdint.h>

uint32_t sbtbuz1(const void * d, uint32_t s, uint32_t seed) {

  uint32_t        i;
  const uint8_t * c;
  uint32_t        hash = seed;

  static const uint32_t buztab[256] = {
    0xb931f966, 0x4ea1856e, 0xd52abe77, 0x5dbd8474, 0x8a0d4a87, 0x10cda4c0,
    0x6fb89ab0, 0x90d2f51e, 0x795e4a09, 0x3600c130, 0x291ba4b6, 0xa53c21d3,
    0x89374ae8, 0xfeefa2fa, 0x805f6ddd, 0xab8be697, 0x37dd2938, 0xe7b0176d,
    0xcb6591a9, 0xfe026d3e, 0x8c94df6d, 0x0192b718, 0x978c9fa5, 0x4c10b702,
    0xb713e55f, 0x56341516, 0xbf5fac14, 0xfa1cb69b, 0xc1e01f28, 0x9d8c1858,
    0xa07bc187, 0xb7d7efd7, 0x5a8875b7, 0xfda4cc03, 0x11fcfbe7, 0xea9bc023,
    0x85a276c8, 0x541a49f7, 0x087c16ea, 0xfb0ff06d, 0x5aef4fa9, 0x700023d7,
    0x46628055, 0x4d17d740, 0xe8da0b9b, 0x260809e0, 0xa81bb01f, 0x619c9275,
    0x9b037fca, 0xd03b1387, 0x68a45090, 0x4af1efa5, 0xcc73bb93, 0xb69d573b,
    0xee3585ef, 0xe5d16f42, 0x1b28bb27, 0x0ee849e6, 0x34b04b69, 0x79bd6e35,
    0x8bc59fa1, 0x6a442793, 0x4a80c631, 0xda531cd8, 0x38a36608, 0x9331e014,
    0x9344b23d, 0x60731a2c, 0x192c2682, 0x0e04a345, 0xcc0b4ed9, 0xf657a398,
    0xf9b3f4f3, 0x5474246a, 0x357d71bb, 0x144f8f8a, 0xf89c6108, 0x445a5bbf,
    0x1b4a143c, 0xf26a82d2, 0xb2e7046f, 0xab4251cc, 0x53eec08c, 0x0b7aacca,
    0x11bbfcaa, 0x062770b9, 0xaa855954, 0x372d312d, 0x884bee20, 0x5696d30a,
    0xee161807, 0x1c414f14, 0xa084e950, 0xb3a9ec5a, 0x0fdb40f0, 0x616b61f9,
    0x803455b3, 0x65d2bb79, 0x3fe8752e, 0xfddec051, 0x9355551d, 0x093b0b50,
    0x9a80a93d, 0x7f45ec15, 0x5d2f0029, 0xba7b7760, 0x138beb9a, 0x0ad08aea,
    0x000c7f85, 0x8e55ffad, 0x35b7d55f, 0xc7eb262b, 0xdba9a896, 0x898b76fe,
    0xd0af1e5e, 0x777194cb, 0x6bf6dc24, 0x5e4339b2, 0x887d1a8c, 0x11ffbd3d,
    0x0243484a, 0x2ccfee4e, 0x30bc5be1, 0x700cb669, 0x424a31d7, 0xd8afc3e7,
    0xdfbcbe80, 0xc4c27ebc, 0x79374ff6, 0xa87c4e05, 0xc6d70560, 0x4de2879b,
    0xeb9eb2b2, 0x260a4023, 0xa760ac85, 0x50c42a28, 0x35366d75, 0x38c76ba7,
    0xbff09364, 0x79f5948f, 0x8927c67d, 0xfa91ac53, 0x1c7d8bd1, 0xd3dd4a08,
    0x5bd800e5, 0x96456e5d, 0x9a268ad7, 0x1e430aee, 0xcbe93aee, 0xefbde31c,
    0x2688b435, 0x7e617b44, 0x46657cbc, 0x4fab173a, 0x6cb98afb, 0x7ccb2d86,
    0xc5d23fea, 0x9ed06967, 0x8ca87042, 0xe249f403, 0x762573b8, 0x63037940,
    0x5d294d47, 0xefc2d78e, 0x82b69c35, 0xc758e59d, 0x627058f2, 0x995da4f1,
    0x4ef7447f, 0xe185355c, 0x769079a0, 0xe05bc9d8, 0xe7ea74d0, 0xb3a2db78,
    0x8c5f0ab1, 0xcd51b0a3, 0xf59cd2a4, 0xc1464629, 0xb7be0ccd, 0xb1da4e40,
    0x33803094, 0x40e2eb33, 0xf5388a88, 0x6595df4a, 0xb9b44bfd, 0x285833a0,
    0x0836ecfd, 0x430bb2d3, 0x49ae9fe5, 0x64b8a396, 0x54213d00, 0x3aba2e2d,
    0xb22c671e, 0xba7e97d6, 0x0b7670aa, 0x70918cc2, 0x7de27168, 0x00ff31c7,
    0x3780572f, 0x0d52b327, 0x28e3338b, 0x2f24421e, 0x586ab0e9, 0x7d17fa47,
    0x37658be9, 0x161e79ad, 0xf48efe8a, 0xef560026, 0x09cb00d5, 0xdf7d3716,
    0xc1790d46, 0x9230d610, 0x1d371070, 0x847955e8, 0xa1d2fc58, 0x86dd7238,
    0x05b638df, 0xa48f05da, 0xb903059e, 0xd9cd5038, 0xa7c5cc91, 0xd5f2cc5b,
    0xc3259c4f, 0xce9d928f, 0x76be7073, 0xeb9e9106, 0xa130e872, 0xa938b67c,
    0x8e770383, 0x5f4ab16e, 0x74ed6696, 0xcb5cbd86, 0x46cb9fbf, 0x5e66f866,
    0x6d668161, 0x35a07cfa, 0xb1b5d4f8, 0x5e879f73, 0xa3aade88, 0xc76a0e75,
    0x8671ef7b, 0x03668bed, 0x3b729154, 0x318d8aec, 0x64eeca03, 0x92f6f716,
    0xa6c559c2, 0x4d0cb097, 0xe46b1f53, 0xb04429c9, 0xe6e9c493, 0x30c3ef45,
    0x7c5da0cf, 0xbd086378, 0xb485883f, 0x6588094d, 
  };
  
  for (c = d, i = s; i; i--, c++) {
    hash = ((hash >> 1) | (hash << 31)) ^ buztab[*c];
  }

  return hash;

}
