// Copyright 2023 Steven Buytaert

#include <stdint.h>

uint32_t sbtbuz2(const void * d, uint32_t s, uint32_t seed) {

  uint32_t        i;
  const uint8_t * c;
  uint32_t        hash = seed;

  static const uint32_t buztab[256] = {
    0xc22c1444, 0x617dd844, 0x0877a5a1, 0x167eb71d, 
    0x35be837b, 0x8cc6cafb, 0x7f051eab, 0x54e89ae6, 
    0x5d48616b, 0xc98a892d, 0x9b27cdf5, 0xa0b0506b, 
    0xf35024b9, 0x26600b5f, 0xe4736ec5, 0x557168f4, 
    0x1b8c8fdd, 0x6b710f75, 0x14b595ae, 0xb0143268, 
    0xe08be7fb, 0xc79b2d61, 0x98bd7741, 0x03d2e60b, 
    0x0f3670c0, 0xfc22ac9d, 0x54ecc015, 0x6a490fcf, 
    0xbc7dca7b, 0x254ac668, 0xfccec889, 0x6ef4c438, 
    0xfc9cec41, 0xa7bb992f, 0x82026c83, 0x40e10d83, 
    0x3c841c58, 0x3b2d1b10, 0xdd2bbd16, 0x732bf1aa, 
    0xa9ee975a, 0xe565e7e9, 0x9e5392f7, 0x0456c320, 
    0x3106e669, 0xff1d37ed, 0x83d4e6b4, 0xff044a4c, 
    0xde4fa1e7, 0x4025115a, 0x0f7a3cf5, 0x0edcc2f4, 
    0xf08a2812, 0xd9aa78c8, 0x87ba0b30, 0x879908fc, 
    0x48ea6c8b, 0xa8ff65c6, 0xc0f411e3, 0x2ee30307, 
    0xb4ea4b13, 0x4eee47ee, 0xb8b42694, 0xf28a92fe, 
    0x07f22137, 0xeb4a0b8e, 0xccc57e6d, 0x7b1dc125, 
    0x6475de98, 0x43a16cbd, 0x33dcf882, 0x0430091b, 
    0x5c14deb9, 0x4115e824, 0x41fa8c87, 0x325b4beb, 
    0x07978151, 0x281a8d22, 0xeaa23f77, 0x8e2a2503, 
    0x95370902, 0x63e76bba, 0x373b73a2, 0x858dd8fe, 
    0x2c576d37, 0x82a2603b, 0x3dcf4d60, 0xeb517871, 
    0x2f415e50, 0xec067908, 0x2878340e, 0x0ad1a9b0, 
    0xba0bb9d0, 0x353e2f47, 0x11f3bc37, 0xfebd7ef8, 
    0xf2d687d1, 0x1e6dc168, 0x4632fb3c, 0xd9912b89, 
    0x1bf61584, 0x25f997e1, 0x5f15bd66, 0x59006019, 
    0x93cf0420, 0x65abc3f1, 0xbb5f1073, 0x76d81c1d, 
    0xcacf0297, 0xdfa8cae8, 0x17623cc8, 0x76d9602e, 
    0x5afced8e, 0xf2eac51a, 0xf33d3ec8, 0x07d7bd96, 
    0x50534ca0, 0xca99e78a, 0x96ff5702, 0x3266ce57, 
    0x9203dcde, 0xa9b861c7, 0xc276afb5, 0x7e098644, 
    0x7631bb55, 0xaa3663c3, 0x2e1405e9, 0x40ea9335, 
    0x57b34224, 0xb4dcd4b5, 0x0fa443b0, 0xd1a0baaa, 
    0x3d27127a, 0xe1f29f69, 0x02cb5de2, 0x020a8d7d, 
    0x5c67a405, 0xa3d566de, 0xd131781b, 0xad86348f, 
    0x142ff0d1, 0xe4a2bd61, 0x73f4c796, 0x5d882fc5, 
    0xa4c5cf82, 0x51c176e2, 0xcf327373, 0x16ef7c7d, 
    0x059371cc, 0xfb22ba3f, 0xcc895218, 0x2f08b545, 
    0x8605d97c, 0x57643a91, 0x3fc53207, 0x95c9f256, 
    0xcb19c0ba, 0x9106c6be, 0xeaad23be, 0x3031dd5e, 
    0x3fc9be0d, 0xc13fce9c, 0xcce84b09, 0x86e9ae06, 
    0xc4d8646b, 0x64cddc42, 0x8d4ec2ec, 0xb9f18200, 
    0x7c047c5e, 0xf117dadc, 0x3636cc7e, 0xbb517386, 
    0xa3b36196, 0xe96e27c2, 0x79ff5280, 0xac7e2ade, 
    0xfe9eab2f, 0x38e9f801, 0x9b3cd67f, 0x7a989e21, 
    0x96dbfa9d, 0xeb56b0c6, 0x81db65c7, 0xc087c510, 
    0xeb06c914, 0x6a50e585, 0x6c580d3c, 0xc3657b90, 
    0x5863d1db, 0xb90f1baf, 0x34d520d8, 0x44859dc0, 
    0x60c214c9, 0xa7fa71a4, 0x8839d208, 0xc685b918, 
    0xf615973d, 0x989ff309, 0x3bac99fe, 0x75d0f697, 
    0xaec6b07a, 0x218c61cb, 0x582606f3, 0x9d0ce8f6, 
    0x8e1218af, 0x39293385, 0x87398167, 0xfd7f3bea, 
    0xdeb815c9, 0x69be677b, 0x1131345a, 0x572bee57, 
    0xc0105598, 0x72b093ef, 0x021100ac, 0x58c56610, 
    0x27828d97, 0x4b1c8a04, 0xbf791fa3, 0xd65312fe, 
    0xfa707671, 0xf163373e, 0x5f45b81c, 0x2dda309d, 
    0xb038cabf, 0x142ab332, 0x130b5c00, 0x4d01c08f, 
    0xb66c7979, 0x40e6b2de, 0x6caebd54, 0xb9e659eb, 
    0x01f89491, 0xc3ce2505, 0xc8092b77, 0xb1d5aec6, 
    0x34d56266, 0x0a356f6f, 0x5e6ebffe, 0x8fa0df70, 
    0xf1d99d62, 0xb85d9963, 0xc84c7706, 0xabc0dc3c, 
    0x798202d7, 0x496332eb, 0x95db9d1b, 0x8bee7535, 
    0xce8d32fa, 0xa16784ad, 0xcc42ce38, 0x651042f1, 
    0x3f2f9a2a, 0x07bff808, 0xbf17b7b4, 0x784ec343, 
  };
 
  for (c = d, i = s; i; i--, c++) {
    hash = ((hash >> 1) | (hash << 31)) ^ buztab[*c];
  }

  return hash;

}

